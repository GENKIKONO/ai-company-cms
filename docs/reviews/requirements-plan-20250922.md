# Back-to-Requirements Plan

**作成日**: 2025-09-22  
**プロジェクト**: GENKIKONO/ai-company-cms  
**目的**: 要件定義への最小修正による健全化

## 前提条件

Gap Reportの分析結果により、実装は99%要件に適合済み。既知症状の大部分は解決済みで、軽微な修正のみが必要。

## Phase 分類

### Phase A（即時・ビルド安定） - 必須
**目的**: 完全な要件適合の達成  
**所要時間**: 30分  
**影響範囲**: ドキュメント（実行コードへの影響なし）

### Phase B（ドメイン整合・保守性向上） - 現時点で不要
**状況**: 実装は既に要件に適合済み

### Phase C（不要物の撤去・ドキュメント更新） - 現時点で不要
**状況**: next-auth等の不要依存関係は既に除去済み

## Phase A 詳細タスク

### A1. APIドキュメント修正
**目的**: サンプルレスポンスからvisibilityフィールドを除去  
**所要時間**: 15分  
**影響範囲**: src/components/api/ApiDocumentation.tsx  
**ロールバック方法**: git revert

**手順**:
1. ApiDocumentationコンポーネント内のサンプルレスポンスを確認
2. `visibility`フィールドが含まれている箇所を特定
3. `status`フィールドのみを使用するよう修正
4. ドキュメントの整合性を確認

**検証方法**:
- ドキュメントページの表示確認
- サンプルコードにvisibilityが含まれていないことを確認

### A2. 最終検証
**目的**: 全体的な要件適合確認  
**所要時間**: 15分  

**手順**:
1. `npm run build` でビルド成功確認
2. `npm run uat:preflight` で基本機能確認（存在する場合）
3. 作成→編集→公開フローの動作確認

## リスク分析

### 低リスク
- **APIドキュメント修正**: 実行コードに影響なし、表示のみの変更

### 想定される問題と対策
1. **ドキュメント表示の崩れ**
   - 対策: 修正前にコンポーネント構造を確認
   - ロールバック: git revert で即座に復旧

2. **他のドキュメントとの不整合**
   - 対策: 関連ドキュメントの一括確認
   - 必要に応じて関連箇所も同時修正

## 成功条件

### Phase A 完了条件
1. ✅ APIドキュメントにvisibilityフィールドが含まれていない
2. ✅ ドキュメントページが正常に表示される
3. ✅ サンプルコードがstatusフィールドを使用している
4. ✅ ビルドエラーが発生しない

## 長期的な保守性向上

### 予防策
1. **定期的な要件適合チェック**: 月次でGap Reportを更新
2. **コードレビュー強化**: 新機能追加時の要件チェック
3. **自動テスト拡充**: 要件違反を検出するテストケース追加

### 監視項目
- 新しいnext-auth依存関係の追加防止
- visibilityフィールドの意図しない復活防止
- ルーティング規則の一貫性維持

## 今回のスコープ外（将来対応）

### 機能拡張時の考慮事項
1. **多言語対応**: status値の国際化
2. **権限管理**: 組織のアクセス制御強化
3. **監査ログ**: 状態変更の履歴管理

### 技術的負債
現時点で技術的負債は最小レベル。定期的なレビューで品質維持。

---

**計画立案**: Claude Code  
**承認者**: 要承認  
**実行予定**: 即時実行可能