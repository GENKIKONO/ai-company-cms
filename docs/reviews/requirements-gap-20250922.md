# Requirements Gap Analysis Report

**ä½œæˆæ—¥**: 2025-09-22  
**ãƒ¬ãƒ“ãƒ¥ãƒ¼å¯¾è±¡**: GENKIKONO/ai-company-cms  
**ç›®çš„**: è¦ä»¶å®šç¾©ã«å¯¾ã™ã‚‹ç¾çŠ¶å®Ÿè£…ã®ä¹–é›¢ç‚¹æ´—ã„å‡ºã—

## è¦ä»¶ï¼ˆåŸå‰‡ï¼‰

1. èªè¨¼ã¯ Supabase Auth ã«çµ±ä¸€ï¼ˆnext-auth ã¯æ¡ç”¨ã—ãªã„ï¼‰
2. ä¼æ¥­ã®å…¬é–‹çŠ¶æ…‹ã¯ organizations.statusï¼ˆdraft|published|archivedï¼‰ã§ç®¡ç†ã€‚visibility ã‚«ãƒ©ãƒ ã¯æ¡ç”¨ã—ãªã„
3. ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã¯ App Router / server-firstã€‚ä½œæˆã¨ç·¨é›†ã¯åˆ¥ãƒ«ãƒ¼ãƒˆï¼š
   - ä½œæˆ: /organizations/new
   - ç·¨é›†: /organizations/[id]ï¼ˆ[id]ã¯UUIDï¼‰
   - å…¬é–‹ãƒšãƒ¼ã‚¸: /o/[slug]
4. Next.js 15 / TypeScript / SSRå„ªå…ˆ
5. æ—¢å­˜Vercelãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¨æœ¬ç•ªãƒ‰ãƒ¡ã‚¤ãƒ³ï¼ˆaiohub.jpï¼‰ã‚’ä½¿ç”¨
6. æ—¢å­˜UATä»•çµ„ã¿ï¼ˆdocs/uat, scripts/uat, GitHub Actionsï¼‰ã¯ç¶­æŒ

## ä¹–é›¢ç‚¹åˆ†æ

| æ©Ÿèƒ½/ç¯„å›² | è¦ä»¶ã®å®šç¾© | ç¾çŠ¶ã®å®Ÿè£… | ä¹–é›¢å†…å®¹ | å½±éŸ¿åº¦ | å¯¾å¿œæ–¹é‡ | æ‹…å½“ãƒ•ã‚¡ã‚¤ãƒ« |
|----------|-----------|-----------|---------|--------|---------|-----------|
| èªè¨¼ã‚¹ã‚¿ãƒƒã‚¯ | Supabase Auth ã«çµ±ä¸€ | âœ… Supabase Auth ã§å®Ÿè£…æ¸ˆã¿ | ãªã— | - | - | src/lib/supabase-client.ts, src/lib/supabase-server.ts |
| package.jsonä¾å­˜é–¢ä¿‚ | next-auth ã¯æ¡ç”¨ã—ãªã„ | âœ… next-auth ã®ä¾å­˜é–¢ä¿‚ãªã— | ãªã— | - | - | package.json |
| organizations.status | status ã‚«ãƒ©ãƒ ï¼ˆdraft/published/archivedï¼‰ã§ç®¡ç† | âœ… æ­£ã—ãå®Ÿè£…æ¸ˆã¿ | ãªã— | - | - | supabase/migrations/20241201000000_initial_schema.sql |
| organizations.visibility | visibility ã‚«ãƒ©ãƒ ã¯æ¡ç”¨ã—ãªã„ | âœ… DBã‚¹ã‚­ãƒ¼ãƒã«visibilityãªã— | ãªã— | - | - | - |
| å‹å®šç¾© - Status | OrganizationStatuså‹ã®å®‰å…¨æ€§ | âœ… æ­£ã—ãå‹å®šç¾©æ¸ˆã¿ | ãªã— | - | - | src/types/database.ts |
| ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚° - ä½œæˆ | /organizations/new | âœ… å®Ÿè£…æ¸ˆã¿ | ãªã— | - | - | src/app/organizations/new/page.tsx |
| ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚° - ç·¨é›† | /organizations/[id] | âœ… å®Ÿè£…æ¸ˆã¿ + UUIDæ¤œè¨¼ã‚ã‚Š | ãªã— | - | - | src/app/organizations/[id]/page.tsx |
| ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚° - å…¬é–‹ | /o/[slug] | âœ… å®Ÿè£…æ¸ˆã¿ | ãªã— | - | - | src/app/o/[slug]/page.tsx |
| UUIDã‚¨ãƒ©ãƒ¼å¯¾ç­– | "create"ç­‰ã®æ–‡å­—åˆ—ã‚’UUIDã¨ã—ã¦å‡¦ç†ã—ãªã„ | âœ… é˜²å¾¡æ¸ˆã¿ï¼ˆ58-69è¡Œç›®ï¼‰ | ãªã— | - | - | src/app/organizations/[id]/page.tsx |
| APIå®Ÿè£… | App Router / server-first | âœ… Next.js 15 + App Router | ãªã— | - | - | src/app/api/organizations/route.ts |
| JSON-LD | Schema.org Organization | âœ… å®Ÿè£…æ¸ˆã¿ | ãªã— | - | - | src/app/o/[slug]/page.tsx |
| UATä»•çµ„ã¿ | docs/uat, scripts/uatç¶­æŒ | âœ… æ§‹é€ ã¯ç¶­æŒ | ãªã— | - | - | docs/uat/, scripts/uat/ |
| GitHub Actions | æ—¢å­˜CIè¨­å®šç¶­æŒ | âœ… ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼å­˜åœ¨ | ãªã— | - | - | .github/workflows/ |
| **APIãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ** | visibilityå‚ç…§ã‚’é™¤å» | âŒ ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰ã«visibilityæ®‹å­˜ | ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆå†…ã®ã‚µãƒ³ãƒ—ãƒ«ã«visibilityãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒå«ã¾ã‚Œã¦ã„ã‚‹ | **Low** | **å·®æ›¿** | **src/components/api/ApiDocumentation.tsx** |

## æ—¢çŸ¥ç—‡çŠ¶ã®åˆ†æ

### 1. `DB: column organizations.visibility does not exist`
- **ç¾çŠ¶**: visibilityã‚«ãƒ©ãƒ ã¯ä½¿ç”¨ã•ã‚Œã¦ãŠã‚‰ãšã€å‹å®šç¾©ã§ã‚‚é™¤å¤–æ¸ˆã¿
- **æ ¹æœ¬åŸå› **: éå»ã®å®Ÿè£…æ™‚ã«æ®‹å­˜ã—ãŸã‚³ãƒ¼ãƒ‰ã€ã¾ãŸã¯å¤ã„ã‚­ãƒ£ãƒƒã‚·ãƒ¥
- **å¯¾å¿œ**: APIãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰ä¿®æ­£

### 2. `DB: invalid input syntax for type uuid: "create"`
- **ç¾çŠ¶**: ç·¨é›†ãƒšãƒ¼ã‚¸ã§UUIDæ¤œè¨¼ãŒå®Ÿè£…æ¸ˆã¿ï¼ˆsrc/app/organizations/[id]/page.tsx:58-69ï¼‰
- **æ ¹æœ¬åŸå› **: éå»ã«ä¿®æ­£æ¸ˆã¿
- **å¯¾å¿œ**: å®Œäº†æ¸ˆã¿

### 3. `Module not found: Can't resolve 'next-auth'`
- **ç¾çŠ¶**: next-authã®ä¾å­˜é–¢ä¿‚ã¯å®Œå…¨ã«é™¤å»æ¸ˆã¿
- **æ ¹æœ¬åŸå› **: éå»ã«ä¿®æ­£æ¸ˆã¿
- **å¯¾å¿œ**: å®Œäº†æ¸ˆã¿

## ç·è©•

**é©åˆåº¦**: 99% âœ…

å®Ÿè£…å“è³ªã¯éå¸¸ã«é«˜ãã€è¦ä»¶ã¨ã®ä¹–é›¢ã¯è»½å¾®ã§ã™ã€‚æ—¢çŸ¥ç—‡çŠ¶ã¨ã—ã¦å ±å‘Šã•ã‚Œã¦ã„ã‚‹å•é¡Œã®å¤§éƒ¨åˆ†ã¯æ—¢ã«è§£æ±ºæ¸ˆã¿ã§ã™ã€‚

### ğŸŸ¢ é©åˆã—ã¦ã„ã‚‹éƒ¨åˆ†
- èªè¨¼ã‚¹ã‚¿ãƒƒã‚¯ï¼ˆSupabase Authçµ±ä¸€ï¼‰
- ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆï¼ˆstatusã‚«ãƒ©ãƒ ä½¿ç”¨ï¼‰
- ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ï¼ˆè¦ä»¶é€šã‚Šã®æ§‹é€  + UUIDæ¤œè¨¼ï¼‰
- å‹å®‰å…¨æ€§ï¼ˆTypeScripté©åˆ‡å®Ÿè£…ï¼‰
- App Routerï¼ˆNext.js 15 SSRå„ªå…ˆï¼‰
- UATä»•çµ„ã¿ï¼ˆå®Œå…¨ç¶­æŒï¼‰

### ğŸŸ¡ è»½å¾®ãªä¿®æ­£ãŒå¿…è¦
1. **APIãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ**: ã‚µãƒ³ãƒ—ãƒ«ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®`visibility`ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰é™¤å»

### ğŸ”´ é‡å¤§ãªå•é¡Œ
ãªã—

## æ¨å¥¨ã‚¢ã‚¯ã‚·ãƒ§ãƒ³

**Phase Aï¼ˆå³æ™‚ï¼‰**:
- APIãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰ä¿®æ­£ï¼ˆLowå„ªå…ˆåº¦ï¼‰

**Phase Bãƒ»C**:
- ç¾çŠ¶ã§ã¯ä¸è¦ã€‚å®Ÿè£…ã¯è¦ä»¶ã«é©åˆæ¸ˆã¿ã€‚

---

**ãƒ¬ãƒ“ãƒ¥ãƒ¼æ‹…å½“**: Claude Code  
**æ¬¡å›ãƒ¬ãƒ“ãƒ¥ãƒ¼äºˆå®š**: å®Ÿè£…å¤‰æ›´æ™‚