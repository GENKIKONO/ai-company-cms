# 実装TODO・ISSUE リスト（優先度順）

## 🔴 High Priority（即座対応必須）

### H1: ナビゲーション規則修正
**ファイル**: `src/components/header/AuthHeader.tsx:23`  
**現状**: ロゴクリックがログイン状態で分岐  
**要件**: ロゴクリック常に `/` 遷移  
**修正**: `href="/"` に統一  
**工数**: 30分  
**検証**: 全ページからロゴクリック→トップページ遷移確認

### H2: 重複データ正規化統一
**ファイル**: 
- `src/app/api/my/organization/route.ts:570-637`
- `src/app/api/organizations/route.ts:154-221`

**現状**: 同一正規化ロジックが重複実装  
**要件**: 統一ライブラリ使用  
**修正**: 
```typescript
// 作成: src/lib/normalize.ts
export function normalizeOrganizationPayload(data: any) { ... }

// 各APIファイルで import & 使用
import { normalizeOrganizationPayload } from '@/lib/normalize';
```
**工数**: 2時間  
**検証**: 全APIでの正規化動作確認

### H3: 本番環境設定修正
**ファイル**: `.env.production`  
**現状**: `SHOW_BUILD_BADGE` 未設定  
**要件**: 本番でコミットバッジ非表示  
**修正**: `SHOW_BUILD_BADGE=false` 追加  
**工数**: 5分  
**検証**: 本番デプロイ後にバッジ非表示確認

## 🟡 Medium Priority（1週間以内）

### M1: メール表示レスポンシブ対応
**ファイル**: `src/components/header/AuthHeader.tsx:50`  
**現状**: 長いメールアドレスでレイアウト崩れの可能性  
**要件**: 狭幅で崩れない（省略＋メニュー格納）  
**修正**: 
```typescript
// PC: max-width + ellipsis
className="max-w-[200px] truncate"

// モバイル: アバターメニュー内に格納
```
**工数**: 4時間  
**検証**: 320px幅での表示確認

### M2: Stripe課金制限完全性確認
**ファイル**: `src/app/api/billing/*`  
**現状**: セルフサーブ限定制限は実装済み  
**要件**: 代理店からの課金APIアクセス完全阻止  
**修正**: 追加テストケースでの検証強化  
**工数**: 2時間  
**検証**: partnerユーザーでの課金API アクセステスト

### M3: JSON-LD構造化データ拡張
**ファイル**: `src/lib/json-ld/`  
**現状**: 基本Organization実装済み  
**要件**: Service/FAQ/CaseStudy/Article完全対応  
**修正**: 各エンティティのJSON-LD生成機能  
**工数**: 8時間  
**検証**: Google構造化データテストツール確認

### M4: E2Eテスト追加
**ファイル**: `tests/e2e/`  
**現状**: 基本認証テストのみ  
**要件**: セルフサーブ・代理店両導線のE2E  
**修正**: Playwright テストケース追加  
**工数**: 12時間  
**検証**: CI/CDでの自動実行確認

## 🟢 Low Priority（2週間以内）

### L1: API使用状況ログ整備
**ファイル**: `src/lib/api/audit-logger.ts`  
**現状**: 基本ログのみ  
**要件**: API使用パターン分析用ログ  
**修正**: 統一ログ収集ミドルウェア  
**工数**: 6時間  
**検証**: ログ収集・分析ダッシュボード確認

### L2: パフォーマンス最適化
**ファイル**: 複数  
**現状**: 基本性能は満足  
**要件**: LCP < 2.5秒、API < 1秒  
**修正**: 画像最適化・クエリ最適化・キャッシュ強化  
**工数**: 16時間  
**検証**: Lighthouse・Core Web Vitals測定

### L3: 診断ツール機能拡張
**ファイル**: `src/app/ops/`  
**現状**: 基本診断実装済み  
**要件**: より詳細な診断・自動修復機能  
**修正**: 詳細診断項目・レポート生成機能  
**工数**: 8時間  
**検証**: 運用時の問題検出・解決能力確認

## 🔧 Technical Debt（適宜対応）

### T1: TypeScript型安全性向上
**影響範囲**: 全体  
**現状**: 一部 `any` 型使用  
**改善**: 厳密型定義・型ガード追加  
**工数**: 20時間

### T2: テストカバレッジ向上
**影響範囲**: `src/` 配下  
**現状**: カバレッジ未測定  
**改善**: Jest単体テスト・カバレッジ80%目標  
**工数**: 24時間

### T3: エラー監視強化
**影響範囲**: 全体  
**現状**: 基本Sentry連携  
**改善**: 詳細エラートラッキング・アラート最適化  
**工数**: 8時間

## 📋 実装スケジュール（推奨）

### Week 1: Critical修正
- [ ] **Day 1**: H1 ナビゲーション規則修正
- [ ] **Day 2-3**: H2 データ正規化統一
- [ ] **Day 3**: H3 本番環境設定
- [ ] **Day 4-5**: 統合テスト・デプロイ検証

### Week 2: 機能強化
- [ ] **Day 1-2**: M1 レスポンシブ対応
- [ ] **Day 3**: M2 課金制限確認
- [ ] **Day 4-5**: M3 JSON-LD拡張

### Week 3-4: 品質向上
- [ ] **Week 3**: M4 E2Eテスト追加
- [ ] **Week 4**: L1-L3 優先度に応じて実装

## 🔍 検収基準

### 各修正の完了条件
1. **機能修正**: 要件定義通りの動作確認
2. **テスト**: 関連テストケース全てPASS
3. **ドキュメント**: 必要に応じて更新
4. **デプロイ**: ステージング→本番環境確認

### リリース判定基準
- [ ] High Priority 項目 100% 完了
- [ ] `/ops/verify` で ALL_GREEN
- [ ] E2E主要シナリオ 100% PASS
- [ ] パフォーマンス基準クリア

---

**担当責務**: 優先度順に修正実施。High Priority未完了でのリリースは禁止。進捗は日次で報告してください。