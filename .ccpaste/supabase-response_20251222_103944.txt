次の観点で、「コードに存在するがDB側へ移す/同期すべき機能」を洗い出すため、質問に順番に回答してください。分かる範囲でOKです。未回答は「不明」としてください。

認証と組織境界
認証: Supabase Auth の JWT に格納している custom claim（例: org_id, user_role）は何がありますか？更新経路は？
RLS: 組織単位のRLSはどのテーブルに適用済み/未適用ですか？未適用のテーブル名を列挙してください。
Realtime: すべて org:{orgId}:{entity} のトピックに統一しましたか？DBトリガーでの broadcast を利用しているテーブルはありますか？
永続化ロジックのコード→DB移譲候補
集計/整形: 現在アプリ側で計算している月次/日次集計、サマリー、ランキングはありますか？関数/マテビュー化の候補を列挙。
検索/フィルタ: アプリ側で複雑な WHERE/JOIN を毎回組み立てている箇所は？SQLビュー/関数化の候補を列挙。
バリデーション: 画面側でのみチェックしているユニーク制約・参照整合・状態遷移制約（例: status の遷移表）は何ですか？
監査/履歴: 変更履歴や監査ログをアプリで記録している箇所は？DBトリガー/監査テーブル化の候補は？
月次レポート領域（今回の主対象）
期間ロジック: toPeriodStart/toPeriodEnd をDB側で関数化する希望はありますか？タイムゾーンの前提は？
一意性: org_id + period_start の一意制約はDBにありますか？なければ追加してよいですか？
ステータス: status の enum（遷移可否ルール）があればDB側で制御しますか？（CHECK制約/トリガー）
取得系: 一覧/最新取得/年-月検索をビュー or 関数化しますか？
インデックス: org_id, period_start で複合インデックスは作成済みですか？
Realtime・非同期処理
どのテーブル更新を broadcast したいですか？イベント種別（INSERT/UPDATE/DELETE）とトピック命名を教えてください。
DBトリガーで realtime.broadcast_changes を使いますか？payload のマスキングや最小化方針は？
長時間処理や外部API連携は Edge Function へ寄せますか？どのトリガーで起動しますか（HTTP/cron/DB）？
ストレージと参照制御
storage.objects のバケット/パス命名とアクセス制御ポリシーはコード側で仮定がありますか？DB側の RLS ポリシーで反映しますか？
ファイルとDBレコードの参照整合（削除時の同期など）はDBトリガーに寄せますか？
セキュリティ・パフォーマンス
現在、RLS条件に用いる列（user_id, org_id, tenant_id）に全てインデックスはありますか？不足列を列挙。
頻出クエリに対する補助インデックス/部分インデックス/マテビューの候補は？
セキュア関数（SECURITY DEFINER）を使っている/使いたい箇所は？誰に EXECUTE を許可しますか？
Advisors の警告（security/performance）はありますか？対応優先度は？
スキーマ整備と命名
テーブル/カラム命名の統一ルール（snake_case、外部キー命名など）は固まっていますか？差分があれば列挙。
enum/ドメイン型の導入予定は？（例: report_status, role_type）
テナント分離のためにスキーマ分割は検討しますか？現状 public 固定ですか？
マイグレーション方針
互換段階の必要要件（ダウンタイム許容/段階的移行/VIEWでのバック互換）を教えてください。
本番反映の順序（DDL→RLS→データ移行→トリガー→切替）の制約はありますか？
制約・前提

破壊的変更（DROP/DELETE など）は明示的に「許可」と記載がある場合のみ提案します。
タイムゾーンは未指定時 UTC を前提に案を作ります。
